<div class="header bg-gradient-cus pb-8 pt-5 pt-md-8">
  <div class="container-fluid">
    <div class="header-body">
      <!-- Card stats -->
      <div class="row">
        <div class="col-xl-3 col-lg-6">
          <div class="card card-stats mb-4 mb-xl-0">
            <div class="card-body">
              <div class="row">
                <div class="col">
                  <h5 class="card-title text-uppercase text-muted mb-0">Tour chưa thanh toán</h5>
                  <span class="h2 font-weight-bold mb-0">{{resTourBookingStatistic.paying}}</span>
                </div>
                <div class="col-auto">
                  <div class="icon icon-shape bg-danger text-white rounded-circle shadow">
                    <i class="fas fa-chart-bar"></i>
                  </div>
                </div>
              </div>
              <p class="mt-3 mb-0 text-muted text-sm">
                <span class="text-success mr-2"><i class="fa fa-arrow-up"></i> 3.48%</span>
                <span class="text-nowrap">Since last month</span>
              </p>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-lg-6">
          <div class="card card-stats mb-4 mb-xl-0">
            <div class="card-body">
              <div class="row">
                <div class="col">
                  <h5 class="card-title text-uppercase text-muted mb-0">Tour đã thanh toán </h5>
                  <span class="h2 font-weight-bold mb-0">{{resTourBookingStatistic.paid}}</span>
                </div>
                <div class="col-auto">
                  <div class="icon icon-shape bg-warning text-white rounded-circle shadow">
                    <i class="fas fa-chart-pie"></i>
                  </div>
                </div>
              </div>
              <p class="mt-3 mb-0 text-muted text-sm">
                <span class="text-danger mr-2"><i class="fas fa-arrow-down"></i> 3.48%</span>
                <span class="text-nowrap">Since last week</span>
              </p>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-lg-6">
          <div class="card card-stats mb-4 mb-xl-0">
            <div class="card-body">
              <div class="row">
                <div class="col">
                  <h5 class="card-title text-uppercase text-muted mb-0">Tour đã hủy</h5>
                  <span class="h2 font-weight-bold mb-0">{{resTourBookingStatistic.cancel}}</span>
                </div>
                <div class="col-auto">
                  <div class="icon icon-shape bg-yellow text-white rounded-circle shadow">
                    <i class="fas fa-users"></i>
                  </div>
                </div>
              </div>
              <p class="mt-3 mb-0 text-muted text-sm">
                <span class="text-warning mr-2"><i class="fas fa-arrow-down"></i> 1.10%</span>
                <span class="text-nowrap">Since yesterday</span>
              </p>
            </div>
          </div>
        </div>
        <div class="col-xl-3 col-lg-6">
          <div class="card card-stats mb-4 mb-xl-0">
            <div class="card-body">
              <div class="row">
                <div class="col">
                  <h5 class="card-title text-uppercase text-muted mb-0">Performance</h5>
                  <span class="h2 font-weight-bold mb-0">49,65%</span>
                </div>
                <div class="col-auto">
                  <div class="icon icon-shape bg-info text-white rounded-circle shadow">
                    <i class="fas fa-percent"></i>
                  </div>
                </div>
              </div>
              <p class="mt-3 mb-0 text-muted text-sm">
                <span class="text-success mr-2"><i class="fas fa-arrow-up"></i> 12%</span>
                <span class="text-nowrap">Since last month</span>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid">
  <h1 class="mt-3 mb-3" style="border-bottom: 1px solid; padding-bottom:10px;">Danh sách tour đăng ký</h1>
  <div class="row">
    <div class="col">
      <div class="card shadow border-0">
        <app-grid-data [rowData]="resTourBooking" [columnDefs]="columnDefs"(gdSearch)="search($event)" (gdChecked)="search($event, true)" [gridConfig]="gridConfig" (gdType)="childType($event)" (gdChild)="childData($event)" (gdRestore)="getData($event)" (gdDelete)="getData($event)"></app-grid-data>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" [id]="gridConfig.idModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="gridDataLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <app-item-tour-booking [resTourBooking]="dataChild" [type]="typeChild" (parentData)="getData($event)"  (parentType)="childType($event)"></app-item-tour-booking>
    </div>
  </div>
</div>



<div class="modal fade" id="updateTour" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="updateTourLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="updateTourLabel">Xác nhận thay đổi tour</h1>
        <button #updateTour type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" *ngIf="data">
        <div class="row mb-3 mt-3">
          <label class="form-label col-4" style="font-weight: 600;">Mã tour</label>
          <p class="col-8" style="color: #2d4271;">{{data.schedule.idSchedule}}</p>
        </div>
        <div class="row">
          <label class="form-label col-4" style="font-weight: 600;">Hành trình</label>
           <p class="col-8" style="color: #2d4271;">{{data.schedule.departurePlace + ' => ' + data.schedule.tour.toPlace}}</p>
        </div>
        <div class="row">
          <label class="form-label col-4" style="font-weight: 600;">Ngày đi</label>
           <p class="col-8" style="color: #2d4271;">{{data.schedule.departureDate | formatFromUnixTimestampToFullDateView}}</p>
        </div>
        <div class="row">
          <label class="form-label col-4" style="font-weight: 600;">Ngày về</label>
           <p class="col-8" style="color: #2d4271;">{{data.schedule.endDate | formatFromUnixTimestampToFullDateView}}</p>
        </div>
        <div class="row mb-3">
          <label class="form-label col-4" style="font-weight: 600;">Nơi khởi hành</label>
           <p class="col-8" style="color: #2d4271;">{{data.schedule.departurePlace}}</p>
        </div>
      </div>
      <div class="modal-footer">
        <ng-container *ngIf="typeChild; else elseType">
          <button type="button" class="btn btn-primary" [attr.data-bs-target]="'#'+gridConfig.idModal" data-bs-toggle="modal">Không</button>
        </ng-container>
        <ng-template #elseType>
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Không</button>
        </ng-template>

        <button type="button" class="btn btn-success" data-bs-dismiss="modal"  >Cập nhật</button>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" id="called" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="calledLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="calledLabel">Gọi xác nhận</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" ></button>
      </div>
      <div class="modal-body" *ngIf="data">
        <div class="row mb-3 mt-3">
          <label class="form-label col-5" style="font-weight: 600;">Tên người liên lạc</label>
          <p class="col-7" style="color: #2d4271;">{{data.nameContact}}</p>
        </div>
        <div class="row">
          <label class="form-label col-5" style="font-weight: 600;">Số điện thoại</label>
           <p class="col-7" style="color: #2d4271;">{{data.phone}}</p>
        </div>
      </div>
      <div class="modal-footer">
        <button #closeCalled type="button" class="btn btn-primary" [attr.data-bs-target]="'#'+gridConfig.idModal" data-bs-toggle="modal">Không</button>
        <button type="button" class="btn btn-success" (click)="called()">Gọi thành công</button>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" id="status" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="statusLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="statusLabel">Thay đổi trạng thái</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" *ngIf="data">
        <div class="row mb-3 mt-3">
          <label class="form-label col-5" style="font-weight: 600;">Tên người liên lạc</label>
          <p class="col-7" style="color: #2d4271;">{{data.nameContact}}</p>
        </div>
        <div class="row">
          <label class="form-label col-5" style="font-weight: 600;">Số điện thoại</label>
           <p class="col-7" style="color: #2d4271;">{{data.phone}}</p>
        </div>
        <div class="row">
          <label class="form-label col-5" style="font-weight: 600;">Trạng thái</label>
          <p class="col-7" style="color: #2d4271;" *ngIf="data.status == -1 || data.status  == 5">
            <span class="badge badge-success" >{{data.status | formatStatusBooking}}</span>
          </p>

          <p class="col-7" style="color: #2d4271;" *ngIf="data.status  == 3">
            <span class="badge badge-info" >{{data.status | formatStatusBooking}}</span>

          </p>

          <p class="col-7" style="color: #2d4271;" *ngIf="data.status  == -2 || data.status  == 1 || data.status  == 2">
            <span class="badge badge-warning" >{{data.status| formatStatusBooking}}</span>
          </p>

          <p class="col-7" style="color: #2d4271;" *ngIf="data.status  == 4 ">
            <span class="badge badge-danger" >{{data.status | formatStatusBooking}}</span>
          </p>
        </div>
      </div>
      <div class="modal-footer">
        <button #closeStatus type="button" class="btn btn-primary" [attr.data-bs-target]="'#'+gridConfig.idModal" data-bs-toggle="modal">Không</button>
        <button type="button" class="btn btn-success" (click)="updateStatus()">Xác nhận</button>
      </div>
    </div>
  </div>
</div>
